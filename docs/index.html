<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriftWatch | Infrastructure Compliance</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg: #0d1117; --card-bg: #161b22; --accent: #58a6ff; --text: #c9d1d9; --neon-green: #3fb950; --neon-red: #f85149; --border: #30363d; --terminal: #010409; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; line-height: 1.5; }
        .container { max-width: 1000px; margin: 0 auto; }
        header { text-align: center; padding: 3rem 0; border-bottom: 1px solid var(--border); margin-bottom: 2.5rem; }
        .author-tag { color: var(--accent); font-size: 0.75rem; font-weight: 700; letter-spacing: 0.15rem; text-transform: uppercase; margin-bottom: 0.5rem; display: block; }
        h1 { margin: 0; font-size: 2.75rem; font-weight: 800; }
        .status-pill { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; background: #21262d; border: 1px solid var(--border); margin-top: 10px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2.5rem; }
        .card { background: var(--card-bg); border: 1px solid var(--border); padding: 1.5rem; border-radius: 12px; }
        .card h3 { margin: 0; font-size: 0.9rem; color: #8b949e; display: flex; align-items: center; gap: 0.75rem; }
        .card .val { font-size: 3.5rem; font-weight: 800; margin: 1rem 0; }
        .card.healthy { border-color: var(--neon-green); }
        .card.healthy .val { color: var(--neon-green); }
        .terminal { background: var(--terminal); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; margin-bottom: 2.5rem; }
        .term-bar { background: #161b22; padding: 10px 18px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .dots { display: flex; gap: 8px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .term-body { height: 350px; overflow-y: auto; padding: 20px; font-family: monospace; font-size: 0.9rem; }
        .cli-line { display: flex; gap: 12px; align-items: center; }
        .prompt { color: var(--neon-green); font-weight: bold; }
        input { background: transparent; border: none; color: #fff; width: 100%; outline: none; font-family: inherit; }
        .roadmap-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 2rem; }
        .rm-category { background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
        .rm-category h3 { margin-top: 0; color: #fff; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        .rm-item { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px; font-size: 0.85rem; color: #8b949e; }
        .rm-item.completed { color: #c9d1d9; }
        .rm-icon.completed { color: var(--accent); }
        footer { text-align: center; margin-top: 4rem; padding: 2rem; color: #8b949e; font-size: 0.8rem; border-top: 1px solid var(--border); }
    </style>
</head>
<body>
<div class="container">
    <header>
        <span class="author-tag">Lead Engineer: Kay Freeman</span>
        <h1>DriftWatch <span style="font-weight: 200; color: #8b949e;">Audit Console</span></h1>
        <div class="status-pill"><i class="fas fa-circle" id="status-dot" style="color: var(--neon-red); font-size: 0.6rem; margin-right: 8px;"></i> <span id="status-text">Live Node: Unsynchronized</span></div>
    </header>

    <div class="stats-grid">
        <div class="card" id="policy-card">
            <h3><i class="fas fa-file-contract"></i> Monitored Policies</h3>
            <div class="val">2</div>
        </div>
        <div class="card" id="drift-card">
            <h3><i class="fas fa-shield-virus"></i> Active Drifts</h3>
            <div class="val" id="drift-val">3</div>
        </div>
    </div>

    <div class="terminal">
        <div class="term-bar">
            <div class="dots"><div class="dot" style="background: #ff5f56;"></div><div class="dot" style="background: #ffbd2e;"></div><div class="dot" style="background: #27c93f;"></div></div>
            <div style="font-size: 0.7rem; color: #8b949e;">kayfreeman@driftwatch ~ zsh</div>
        </div>
        <div class="term-body" id="term-body">
            <div id="term-output"></div>
            <div class="cli-line"><span class="prompt">driftwatch %</span><input type="text" id="cli-input" autofocus autocomplete="off"></div>
        </div>
    </div>

    <h2 style="border-bottom: 1px solid var(--border); padding-bottom: 10px;">Project Roadmap</h2>
    <div id="roadmap-grid" class="roadmap-grid"></div>

    <footer>&copy; 2026 Kay Freeman | MIT License</footer>
</div>

<script>
    const input = document.getElementById('cli-input');
    const output = document.getElementById('term-output');
    const body = document.getElementById('term-body');
    const driftVal = document.getElementById('drift-val');
    const driftCard = document.getElementById('drift-card');
    const statusText = document.getElementById('status-text');
    const statusDot = document.getElementById('status-dot');
    const roadmapGrid = document.getElementById('roadmap-grid');

    let state = { isHealthy: sessionStorage.getItem('dw_isHealthy') === 'true', roadmapData: [] };

    async function syncRoadmap() {
        try {
            const response = await fetch('../README.md');
            const text = await response.text();
            const section = text.split('## Project Roadmap')[1]?.split('---')[0];
            if (!section) return;

            const categories = section.split('###').filter(c => c.trim() !== "");
            state.roadmapData = categories.map(cat => {
                const lines = cat.trim().split('\n');
                return {
                    title: lines[0].trim(),
                    items: lines.slice(1).filter(l => l.includes('ðŸ”µ') || l.includes('âšª')).map(l => ({
                        done: l.includes('ðŸ”µ'),
                        text: l.replace(/[ðŸ”µâšª*]/g, '').trim()
                    }))
                };
            });
            renderRoadmap();
        } catch (e) { console.error("Sync Failed", e); }
    }

    function renderRoadmap() {
        roadmapGrid.innerHTML = state.roadmapData.map(cat => `
            <div class="rm-category">
                <h3>${cat.title}</h3>
                ${cat.items.map(i => `
                    <div class="rm-item ${i.done ? 'completed' : 'pending'}">
                        <i class="${i.done ? 'fas fa-circle-check rm-icon completed' : 'far fa-circle rm-icon'}"></i>
                        <div>${i.text}</div>
                    </div>
                `).join('')}
            </div>
        `).join('');
    }

    function updateDashboard() {
        if (state.isHealthy) {
            driftVal.innerText = '0';
            driftCard.classList.add('healthy');
            statusText.innerText = 'Live Node: Synchronized';
            statusDot.style.color = 'var(--neon-green)';
        }
    }

    function handleCommand(val) {
        const cmd = val.trim();
        output.innerHTML += `<div class="cli-line"><span class="prompt">driftwatch %</span> ${cmd}</div>`;
        if(cmd === 'npm start -- --fix') {
            state.isHealthy = true;
            sessionStorage.setItem('dw_isHealthy', 'true');
            updateDashboard();
            output.innerHTML += `<div>âœ” SUCCESS: Remediation applied.</div>`;
        } else {
            output.innerHTML += `<div>Command executed.</div>`;
        }
        input.value = "";
        body.scrollTop = body.scrollHeight;
    }

    input.addEventListener('keydown', (e) => { if(e.key === 'Enter') handleCommand(input.value); });
    syncRoadmap();
    updateDashboard();
</script>
</body>
</html>